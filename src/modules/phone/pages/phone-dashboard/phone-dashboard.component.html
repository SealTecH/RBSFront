<mat-spinner class="page-spinner" *ngIf="loading$ | async;else repair"></mat-spinner>
<ng-template #repair>
  <div>
    <mat-form-field appearance="fill" class="search-control">
      <mat-label>Search</mat-label>
      <input matInput class="search-control" [formControl]="searchControl" placeholder="search">
    </mat-form-field>
    <button mat-raised-button class="navigation-btn" color="warn" [disabled]="!searchControl.value" (click)="clearSearch()"> Clear </button>
  </div>
 <div class="btn-container">
   <button  mat-raised-button class="content-button" (click)="createNewRepair()">New Repair</button>
   <button mat-raised-button class="content-button" color="warn" [disabled]="selectedRow===null" (click)="deleteRow()">Delete</button>
   <button mat-raised-button class="content-button" [disabled]="selectedRow===null" (click)="goToDetails()">Details</button>
   <button mat-raised-button class="content-button" [disabled]="selectedRow===null" (click)="changeStatus()">Change Status</button>
 </div>
  <div>
    <table mat-table [dataSource]="repairsFiltered$ | async" class="mat-elevation-z8">

      <ng-container matColumnDef="model">
        <th mat-header-cell *matHeaderCellDef class="model-cell"> Model </th>
        <td mat-cell *matCellDef="let repair" class="model-cell">
          {{ repair.manufacturer }} <br>
          {{ repair.model }} <br>
          {{ repair.phoneNumber }}
        </td>
      </ng-container>

      <ng-container matColumnDef="malfunction">
        <th mat-header-cell *matHeaderCellDef> Malfunction </th>
        <td mat-cell *matCellDef="let repair"> {{ repair.malfunctions }} </td>
      </ng-container>

      <ng-container matColumnDef="cost">
        <th mat-header-cell *matHeaderCellDef class="cost-cell"> Cost </th>
        <td mat-cell *matCellDef="let repair" class="cost-cell">
          {{repair.cost}}
        </td>
      </ng-container>

      <ng-container matColumnDef="created">
        <th mat-header-cell *matHeaderCellDef class="date-cell"> Created Date </th>
        <td mat-cell *matCellDef="let repair" class="date-cell">
          {{ getDate(repair.createDate)}}
        </td>
      </ng-container>

      <ng-container matColumnDef="comments">
        <th mat-header-cell *matHeaderCellDef> Comments </th>
        <td mat-cell *matCellDef="let repair">
          {{ repair.comments }}
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef class="status-cell"> Status </th>
        <td mat-cell *matCellDef="let repair" class="status-cell">
          {{ repair.status }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columns"></tr>
      <tr mat-row [class.selected]="row.id===selectedRow?.id"
          [class.ready]="row.status===RepairStatus.Done && row.id!==selectedRow?.id"
          *matRowDef="let row; columns: columns;" (click)="selectRow(row)" ></tr>

      <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                     showFirstLastButtons
                     aria-label="Select page of repairs">
      </mat-paginator>
    </table>
  </div>

</ng-template>
